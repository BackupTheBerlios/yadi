# $Id: common_gui_changes,v 1.3 2004/04/28 23:29:37 alexh Exp $
# is part of yadi-script-pack
#
# Copyright (c) 2004 AlexH, essu Germany. All rights reserved.
# Mail: alexh@berlios.de
#
# aktuelle Versionen gibt es hier:
# $Source: /home/xubuntu/berlios_backup/github/tmp-cvs/yadi/Repository/scripts/common_gui_changes,v $
#
# This program is free software; you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published
# by the Free Software Foundation; either version 2 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful, but
# WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU
# General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program; if not, write to the Free Software Foundation,
# Inc., 675 Mass Ave, Cambridge MA 02139, USA.
#
# Mit diesem Programm koennen Images fuer DBox2 erstellt werden
#
# -------------------------------------------------------
#
 
cd $CVS/cdk

# Udpstreampes ins Flash aufnehmen
cp $DBOX/cdkroot/sbin/udpstreampes $DBOX/cdkflash/root/sbin

# Top kopieren
cp $DBOX/cdkroot/bin/top $DBOX/cdkflash/root/bin

# eraseall ins Flash aufnehmen
cp $DBOX/cdkroot/sbin/eraseall $DBOX/cdkflash/root/sbin

# rcs kopieren
# patch -N -p0 $DBOX/cdkflash/root/etc/init.d/rcS $CHANGE_DIR/Patches/rcS.diff
cp $CHANGE_DIR/Configs/rcS.local $DBOX/cdkflash/root/etc/init.d/
cp $CHANGE_DIR/Configs/rcS $DBOX/cdkflash/root/etc/init.d/

# Logos kopieren
mkdir $DBOX/cdkflash/root/var/tuxbox/boot
cp $CHANGE_DIR/Logos/yadi2_logo-fb $DBOX/cdkflash/root/var/tuxbox/boot/logo-fb

cp $CHANGE_DIR/Logos/logo-lcd $DBOX/cdkflash/root/var/tuxbox/boot

# ppcboot kopiern
cp $DBOX/cdkflash/root/boot/ppcboot.conf $DBOX/cdkflash/root/var/tuxbox/boot/boot.conf

# Iso kopieren
#mkdir $DBOX/cdkflash/root/share/iso-codes
# cp $DBOX/cdkroot/share/iso-codes/iso-639.tab $DBOX/cdkflash/root/share/iso-codes/

# XMLs kopieren
cp $DBOX/cdkroot/share/tuxbox/*.xml $DBOX/cdkflash/root/share/tuxbox/
#patch -N -p0 $DBOX/cdkflash/root/share/tuxbox/cables.xml $CHANGE_DIR/Patches/cables.xml.diff

# Interfaces loeschen
rm $DBOX/cdkflash/root/etc/network/interfaces

# Start-Dateien kopieren
cp $CHANGE_DIR/Configs/start $DBOX/cdkflash/root/etc/init.d

if [ -e $DBOX/cdkflash/root/etc/init.d/start_neutrino ]; then
  chmod a+x $DBOX/cdkflash/root/etc/init.d/start_neutrino
fi

if [ -e $DBOX/cdkflash/root/etc/init.d/start_enigma ]; then
  chmod a+x $DBOX/cdkflash/root/etc/init.d/start_enigma
fi

# profile kopieren
cp CHANGE_DIR/Configs/profile $DBOX/cdkflash/etc/

# Root-Home erstellen
# mkdir $DBOX/cdkflash/root/root

# lcdip kopieren
#cp $CHANGE_DIR/bin/lcdip $DBOX/cdkflash/root/bin/
cp $CHANGE_DIR/bin/lcdip $DBOX/cdkflash/root/bin/

# Ucode-Checker kopieren
cp $CHANGE_DIR/bin/chkucodes $DBOX/cdkflash/root/sbin/

# Image-Infos kopieren, falls existent
if  [ -e $VE ]; then
  cp $VE $DBOX/cdkflash/root/.version
fi
# Teletext auf blaue Taste legen
mv $DBOX/cdkflash/root/lib/tuxbox/plugins/tuxtxt.cfg $DBOX/cdkflash/root/lib/tuxbox/plugins/_tuxtxt.cfg
mv $DBOX/cdkflash/root/lib/tuxbox/plugins/tuxtxt.so $DBOX/cdkflash/root/lib/tuxbox/plugins/_tuxtxt.so

# Ein paar Dateien linken
cd $DBOX/cdkflash/root/sbin/

rm telnetd
ln -sf /bin/busybox telnetd

rm inetd
ln -s /bin/busybox inetd

rm depmod
ln -s /bin/busybox depmod

rm insmod
ln -s /bin/busybox insmod

cd $DBOX/cdkflash/root/bin/
ln -sf /bin/busybox ps

#Disclaimer kopieren
cp $CHANGE_DIR/Configs/disclaimer.txt $DBOX/cdkflash/root/

# saa kopieren
cp $DBOX/cdkroot/bin/saa $DBOX/cdkflash/root/bin/

# lircd kopieren
cp $DBOX/cdkroot/sbin/lircd $DBOX/cdkflash/root/sbin/

#getset-Files anlegen
if [ ! -d $DBOX/cdkflash/root/var/plugins ]; then
 mkdir $DBOX/cdkflash/root/var/plugins
fi
cp $ROOT/yadi-cvs/patches/getset/getset* $DBOX/cdkflash/root/var/plugins/
chmod 500 $DBOX/cdkflash/root/var/plugins/getset

